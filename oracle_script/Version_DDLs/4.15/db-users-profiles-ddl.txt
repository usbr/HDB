--uchdb2 prod user and profile (couldn't connect uc test)

APP_REMOTE	OPEN	HDB_APP_PROFILE
APP_USER	OPEN	GSM_PROF
CP_PROCESS	OPEN	HDB_APP_PROFILE
CZAR_USER	OPEN	HDB_APP_PROFILE
DECODES		LOCKED	HDB_APP_PROFILE
LRGSDECODES	OPEN	HDB_APP_PROFILE
META_DATA_USER	OPEN	GSM_PROF
PSSWD_USER	OPEN	GSM_PROF
UCHDBA		OPEN	HDB_APP_PROFILE

CREATE PROFILE "DEFAULT"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 1440
    CONNECT_TIME 180000
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 5
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME UNLIMITED
    PASSWORD_REUSE_MAX 20
    PASSWORD_VERIFY_FUNCTION ORA12C_STIG_VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;
    
CREATE PROFILE "HDB_APP_PROFILE"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER 100
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME 1440
    CONNECT_TIME 10080
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 20
    PASSWORD_VERIFY_FUNCTION ORA12C_STIG_VERIFY_FUNCTION
    PASSWORD_LOCK_TIME .012
    PASSWORD_GRACE_TIME 35
    ;
    
CREATE PROFILE "HDB_USER_PROFILE"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER 150
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME 100
    CONNECT_TIME 600
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 20
    PASSWORD_VERIFY_FUNCTION ORA12C_STIG_VERIFY_FUNCTION
    PASSWORD_LOCK_TIME .012
    PASSWORD_GRACE_TIME 35
    ;

CREATE PROFILE "MV_LOCK_TIME"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER DEFAULT
    CPU_PER_SESSION DEFAULT
    CPU_PER_CALL DEFAULT
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME DEFAULT
    CONNECT_TIME DEFAULT
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME DEFAULT
    PASSWORD_REUSE_MAX DEFAULT
    PASSWORD_VERIFY_FUNCTION DEFAULT
    PASSWORD_LOCK_TIME .0104
    PASSWORD_GRACE_TIME DEFAULT
    ;
    
--We shouldn't use this profile.It is used by oracle system users. 
CREATE PROFILE "GSM_PROF"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER 250
    CPU_PER_SESSION DEFAULT
    CPU_PER_CALL DEFAULT
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME DEFAULT
    CONNECT_TIME DEFAULT
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 5
    PASSWORD_LIFE_TIME UNLIMITED
    PASSWORD_REUSE_TIME DEFAULT
    PASSWORD_REUSE_MAX DEFAULT
    PASSWORD_VERIFY_FUNCTION NULL
    PASSWORD_LOCK_TIME DEFAULT
    PASSWORD_GRACE_TIME 5
    ;
    
  CREATE OR REPLACE  FUNCTION "SYS"."ORA12C_STIG_VERIFY_FUNCTION" 
 ( username varchar2,
   password varchar2,
   old_password varchar2)
 return boolean IS
   differ integer;
begin
   if not ora_complexity_check(password, chars => 15, upper => 1, lower => 1,
                           digit => 1, special => 1) then
      return(false);
   end if;

   -- Check if the password differs from the previous password by at least
   -- 8 characters
   if old_password is not null then
      differ := ora_string_distance(old_password, password);
      if differ < 8 then
         raise_application_error(-20033, 'The new password should differ '
					|| 'from the previous password by '
					|| 'at least 8 characters.');
      end if;
   end if;

   return(true);
end;
GRANT EXECUTE ON "SYS"."ORA12C_STIG_VERIFY_FUNCTION" TO PUBLIC;


--LC prod

APP_USER	OPEN	APP_USER_PROFILE
CP_PROCESS	OPEN	DEFAULT
DECODES		OPEN	DEFAULT
LCHDBA		OPEN	DEFAULT
META_DATA_USER	OPEN	DEFAULT
PSSWD_USER	OPEN	DEFAULT

CREATE PROFILE "DEFAULT"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER UNLIMITED
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME UNLIMITED
    CONNECT_TIME UNLIMITED
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 10
    PASSWORD_LIFE_TIME UNLIMITED
    PASSWORD_REUSE_TIME UNLIMITED
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION NULL
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 7
    ;
    
CREATE PROFILE "APP_USER_PROFILE"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER UNLIMITED
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME UNLIMITED
    CONNECT_TIME UNLIMITED
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS UNLIMITED
    PASSWORD_LIFE_TIME UNLIMITED
    PASSWORD_REUSE_TIME UNLIMITED
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION NULL
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 7
    ;
    

--LC dev
APP_USER	OPEN	DEFAULT
CP_PROCESS	OPEN	DEFAULT
CZAR_USER	OPEN	DEFAULT
DECODES		OPEN	DEFAULT
LCHDBA		OPEN	DEFAULT
META_DATA_USER	EXPIRED(GRACE)	DEFAULT
OPS$LCHDBA	OPEN	DEFAULT
PSSWD_USER	OPEN	DEFAULT


CREATE PROFILE "DEFAULT"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER UNLIMITED
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME UNLIMITED
    CONNECT_TIME UNLIMITED
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 10
    PASSWORD_LIFE_TIME 180
    PASSWORD_REUSE_TIME UNLIMITED
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION NULL
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 7
    ;
    


-- YAO prod
APP_USER	OPEN	DEFAULT
BORAUDIT	OPEN	BOR_ADMIN
CP_PROCESS	OPEN	DEFAULT
DECODES		OPEN	DEFAULT
META_DATA_USER	OPEN	DEFAULT
PSSWD_USER	OPEN	DEFAULT
YAOHDBA		OPEN	DEFAULT

CREATE PROFILE "DEFAULT"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER UNLIMITED
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME UNLIMITED
    CONNECT_TIME UNLIMITED
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 10
    PASSWORD_LIFE_TIME UNLIMITED
    PASSWORD_REUSE_TIME UNLIMITED
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION NULL
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 7
    ;
    
CREATE PROFILE "BOR_ADMIN"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER DEFAULT
    CPU_PER_SESSION DEFAULT
    CPU_PER_CALL DEFAULT
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME DEFAULT
    CONNECT_TIME DEFAULT
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 365
    PASSWORD_REUSE_TIME 450
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION COMPLEXITY_VERIFICATION_FUNC  --this function is very old.
    PASSWORD_LOCK_TIME .0102
    PASSWORD_GRACE_TIME 10
    ;
 
 
 -- YAO test
 
 APP_USER	OPEN	DEFAULT
 BORAUDIT	OPEN	BOR_ADMIN
 CP_PROCESS	OPEN	DEFAULT
 DECODES	OPEN	DEFAULT
 META_DATA_USER	OPEN	DEFAULT
 PSSWD_USER	OPEN	DEFAULT
 YAOHDBA	OPEN	DEFAULT
 
 CREATE PROFILE "DEFAULT"
 LIMIT
     COMPOSITE_LIMIT UNLIMITED
     SESSIONS_PER_USER UNLIMITED
     CPU_PER_SESSION UNLIMITED
     CPU_PER_CALL UNLIMITED
     LOGICAL_READS_PER_SESSION UNLIMITED
     LOGICAL_READS_PER_CALL UNLIMITED
     IDLE_TIME UNLIMITED
     CONNECT_TIME UNLIMITED
     PRIVATE_SGA UNLIMITED
     FAILED_LOGIN_ATTEMPTS 10
     PASSWORD_LIFE_TIME 180
     PASSWORD_REUSE_TIME UNLIMITED
     PASSWORD_REUSE_MAX UNLIMITED
     PASSWORD_VERIFY_FUNCTION NULL
     PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 7
    ;
    
CREATE PROFILE "BOR_ADMIN"
LIMIT
    COMPOSITE_LIMIT DEFAULT
    SESSIONS_PER_USER DEFAULT
    CPU_PER_SESSION DEFAULT
    CPU_PER_CALL DEFAULT
    LOGICAL_READS_PER_SESSION DEFAULT
    LOGICAL_READS_PER_CALL DEFAULT
    IDLE_TIME DEFAULT
    CONNECT_TIME DEFAULT
    PRIVATE_SGA DEFAULT
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 365
    PASSWORD_REUSE_TIME 450
    PASSWORD_REUSE_MAX UNLIMITED
    PASSWORD_VERIFY_FUNCTION COMPLEXITY_VERIFICATION_FUNC
    PASSWORD_LOCK_TIME .0102
    PASSWORD_GRACE_TIME 10
    ;


--EC prod

APP_USER	OPEN	SERVICE
CP_PROCESS	OPEN	SERVICE
DECODES		OPEN	SERVICE
FRYARK_HDB_UPDATE OPEN	SERVICE
META_DATA_USER	OPEN	SERVICE
PSSWD_USER	OPEN	SERVICE


CREATE PROFILE "DEFAULT"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 480
    CONNECT_TIME 1440
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 90
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;

CREATE PROFILE "BOR_ADMIN"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 480
    CONNECT_TIME 1440
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 90
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;

CREATE PROFILE "HDB"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 480
    CONNECT_TIME 1440
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;


CREATE PROFILE "HDB_TEMP"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 480
    CONNECT_TIME 1440
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 60
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;


CREATE PROFILE "SCHEMA"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 10
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME 480
    CONNECT_TIME 1440
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 90
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;


CREATE PROFILE "SERVICE"
LIMIT
    COMPOSITE_LIMIT UNLIMITED
    SESSIONS_PER_USER 30
    CPU_PER_SESSION UNLIMITED
    CPU_PER_CALL UNLIMITED
    LOGICAL_READS_PER_SESSION UNLIMITED
    LOGICAL_READS_PER_CALL UNLIMITED
    IDLE_TIME UNLIMITED
    CONNECT_TIME UNLIMITED
    PRIVATE_SGA UNLIMITED
    FAILED_LOGIN_ATTEMPTS 3
    PASSWORD_LIFE_TIME 90
    PASSWORD_REUSE_TIME 365
    PASSWORD_REUSE_MAX 24
    PASSWORD_VERIFY_FUNCTION VERIFY_FUNCTION  -- This function is old
    PASSWORD_LOCK_TIME 1
    PASSWORD_GRACE_TIME 5
    ;


-- Can't access LBOHDB and CUHDB- WIP